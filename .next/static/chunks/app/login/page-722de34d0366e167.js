(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4520],{2698:(e,i,n)=>{"use strict";n.d(i,{default:()=>d});var t=n(5155),r=n(2115),s=n(2108),o=n(5695),a=n(4814),l=n.n(a);function d(){let[e,i]=(0,r.useState)(""),[n,a]=(0,r.useState)(""),[d,c]=(0,r.useState)(""),[u,p]=(0,r.useState)(1),[g,h]=(0,r.useState)(""),[m,_]=(0,r.useState)(!1),x=(0,o.useRouter)(),j=(0,r.useRef)(null);(0,r.useEffect)(()=>{2===u&&j.current&&j.current.focus()},[u]);let v=async i=>{i.preventDefault(),_(!0),h("");let t=await (0,s.signIn)("credentials",{redirect:!1,email:e.trim(),password:n,role:"user",...2===u?{otp:d.trim()}:{}});if(_(!1),null==t?void 0:t.error)try{let e=JSON.parse(t.error);"OTP_REQUIRED"===e.code?(p(2),h("✅ OTP sent to your email. Please enter it below.")):h(e.message||"❌ Login failed.")}catch(e){h(t.error)}else x.push("/user/dashboard")},b=async()=>{_(!0),h("");let i=await fetch("/api/auth/send-otp",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e.trim(),role:"user"})}),n=await i.json();_(!1),i.ok?(p(2),h("✅ OTP sent to your email. Please enter it below.")):h((null==n?void 0:n.error)||"❌ Failed to send OTP.")},y=async()=>{_(!0),h("");let i=await fetch("/api/auth/send-otp",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e.trim(),role:"user"})}),n=await i.json();_(!1),i.ok?h("✅ OTP resent. Check your inbox."):h((null==n?void 0:n.error)||"❌ Failed to resend OTP.")};return(0,t.jsx)("div",{className:l().loginContainer,children:(0,t.jsxs)("div",{className:l().loginCard,children:[(0,t.jsxs)("div",{className:l().loginHeader,children:[(0,t.jsx)("h2",{children:"User Login"}),(0,t.jsx)("p",{children:"Welcome back! Please enter your details to sign in."})]}),(0,t.jsxs)("form",{onSubmit:v,className:l().loginForm,children:[1===u&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{className:l().inputGroup,children:[(0,t.jsx)("label",{htmlFor:"email",children:"Email"}),(0,t.jsx)("input",{id:"email",type:"email",placeholder:"Enter your email",value:e,onChange:e=>i(e.target.value),required:!0})]}),(0,t.jsxs)("div",{className:l().inputGroup,children:[(0,t.jsx)("label",{htmlFor:"password",children:"Password"}),(0,t.jsx)("input",{id:"password",type:"password",placeholder:"Enter your password",value:n,onChange:e=>a(e.target.value),required:!0})]}),(0,t.jsx)("button",{type:"button",onClick:b,disabled:!e||m,className:l().otpLink,children:m?"Sending OTP...":"Send OTP to Email"})]}),2===u&&(0,t.jsxs)("div",{className:l().otpContainer,children:[(0,t.jsxs)("div",{className:l().otpHeader,children:[(0,t.jsx)("h3",{children:"Verification Required"}),(0,t.jsx)("p",{children:"We've sent a 6-digit code to your email"})]}),(0,t.jsxs)("div",{className:l().inputGroup,children:[(0,t.jsx)("label",{htmlFor:"otp",children:"Enter verification code"}),(0,t.jsx)("input",{ref:j,id:"otp",type:"text",placeholder:"Enter 6-digit code",value:d,onChange:e=>c(e.target.value),maxLength:6,pattern:"\\d{6}",inputMode:"numeric",required:!0})]}),(0,t.jsxs)("div",{className:l().otpResend,children:[(0,t.jsx)("p",{children:"Didn't receive the code?"}),(0,t.jsx)("button",{type:"button",onClick:y,disabled:m,children:m?"Sending...":"Resend code"})]})]}),(0,t.jsx)("button",{type:"submit",disabled:m,className:l().submitButton,children:m?1===u?"Logging in...":"Verifying...":1===u?"Login":"Verify & Login"}),g&&(0,t.jsx)("div",{className:"".concat(l().message," ").concat(g.toLowerCase().includes("success")||g.includes("✅")?l().success:l().error),children:g})]}),(0,t.jsx)("div",{className:l().cardFooter,children:(0,t.jsxs)("p",{children:["Having trouble signing in? ",(0,t.jsx)("a",{href:"/register",children:"Register here"})]})})]})})}},4457:(e,i,n)=>{Promise.resolve().then(n.bind(n,2698))},4814:e=>{e.exports={loginContainer:"Login_loginContainer__hA_pw",loginCard:"Login_loginCard__SHhGx",loginHeader:"Login_loginHeader__NMeno",loginForm:"Login_loginForm__xVBFv",inputGroup:"Login_inputGroup__8lUG9",otpLink:"Login_otpLink__xvWQt",otpContainer:"Login_otpContainer__Z6EQi",otpHeader:"Login_otpHeader__BygG_",otpResend:"Login_otpResend__DDHXb",submitButton:"Login_submitButton__LYzpR",message:"Login_message__NVGU_",success:"Login_success__v2F9N",error:"Login_error__1AWB3",cardFooter:"Login_cardFooter__cdbUX"}},5695:(e,i,n)=>{"use strict";var t=n(8999);n.o(t,"useRouter")&&n.d(i,{useRouter:function(){return t.useRouter}})}},e=>{e.O(0,[2805,2108,8441,5964,7358],()=>e(e.s=4457)),_N_E=e.O()}]);