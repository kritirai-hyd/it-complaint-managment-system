(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2454],{2340:e=>{e.exports={registerContainer:"Register_registerContainer__KVI5A",registerCard:"Register_registerCard__MvcoV",fadeIn:"Register_fadeIn__U2IUS",progressBar:"Register_progressBar__xTQTS",cardHeader:"Register_cardHeader__XYgKn",title:"Register_title__HyV3K",subtitle:"Register_subtitle__mBGEU",message:"Register_message__0g9fP",slideIn:"Register_slideIn__uQqDU",success:"Register_success__6rrOb",error:"Register_error__Su685",form:"Register_form__kR5M4",inputGroup:"Register_inputGroup__BGTGn",otpContainer:"Register_otpContainer__Kufje",otpInput:"Register_otpInput__qCmxx",btnPrimary:"Register_btnPrimary__IRs3i",btnSecondary:"Register_btnSecondary__ygUU5",otpNote:"Register_otpNote__NhJXw",cardFooter:"Register_cardFooter__G5174",link:"Register_link__uVPUR",spinner:"Register_spinner__UAgda",spin:"Register_spin__Mk2Sw"}},3859:(e,t,r)=>{"use strict";r.d(t,{default:()=>d});var s=r(5155),a=r(2115),n=r(6874),i=r.n(n),o=r(5695),c=r(2340),l=r.n(c);function d(){let[e,t]=(0,a.useState)(1),[r,n]=(0,a.useState)({name:"",email:"",phone:"",password:"",role:"user",otp:""}),[c,d]=(0,a.useState)(!1),[p,u]=(0,a.useState)({text:"",type:""}),[m,_]=(0,a.useState)(0),h=(0,a.useRef)(null),g=(0,o.useRouter)();(0,a.useEffect)(()=>{2===e&&h.current&&h.current.focus()},[e]),(0,a.useEffect)(()=>{if(c){let e=setInterval(()=>{_(e=>Math.min(e+10,90))},300);return()=>clearInterval(e)}_(0)},[c]);let y=e=>{n({...r,[e.target.name]:e.target.value})},x=async e=>{e.preventDefault(),d(!0),u({text:"",type:""});try{let e=await fetch("/api/register/request-otp",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:r.name,email:r.email,phone:r.phone,password:r.password})}),s=await e.json();e.ok?(t(2),u({text:"OTP sent to your email. Please verify.",type:"success"})):u({text:s.error||"Registration failed.",type:"error"})}catch(e){u({text:"An error occurred.",type:"error"})}finally{d(!1)}},f=async e=>{e.preventDefault(),d(!0),u({text:"",type:""}),_(10);try{let e=await fetch("/api/register/verify-otp",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:r.email,otp:r.otp,name:r.name,phone:r.phone,password:r.password})}),t=await e.json();e.ok?(_(100),u({text:"Registration successful. Redirecting...",type:"success"}),setTimeout(()=>{g.push("/login")},1500)):u({text:t.error||"OTP verification failed.",type:"error"})}catch(e){u({text:"An error occurred.",type:"error"})}finally{d(!1)}},j=async()=>{u({text:"",type:""}),d(!0);try{let e=await fetch("/api/register/request-otp",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:r.name,email:r.email,phone:r.phone,password:r.password})}),t=await e.json();e.ok?u({text:"New OTP sent to your email.",type:"success"}):u({text:t.error||"Failed to resend OTP.",type:"error"})}catch(e){u({text:"Error occurred while resending OTP.",type:"error"})}finally{d(!1)}};return(0,s.jsx)("div",{className:l().registerContainer,children:(0,s.jsxs)("div",{className:l().registerCard,children:[(0,s.jsx)("div",{className:l().progressBar,style:{width:"".concat(m,"%")}}),(0,s.jsxs)("div",{className:l().cardHeader,children:[(0,s.jsx)("h2",{className:l().title,children:1===e?"Create Account":"Verify Email"}),(0,s.jsx)("p",{className:l().subtitle,children:1===e?"Join us today!":"Enter the code sent to ".concat(r.email)})]}),p.text&&(0,s.jsx)("div",{className:"".concat(l().message," ").concat("success"===p.type?l().success:l().error),children:p.text}),1===e?(0,s.jsxs)("form",{onSubmit:x,className:l().form,children:[(0,s.jsx)("div",{className:l().inputGroup,children:(0,s.jsx)("input",{name:"name",placeholder:"Full Name",onChange:y,required:!0,disabled:c})}),(0,s.jsx)("div",{className:l().inputGroup,children:(0,s.jsx)("input",{name:"email",placeholder:"Email Address",type:"email",onChange:y,required:!0,disabled:c})}),(0,s.jsx)("div",{className:l().inputGroup,children:(0,s.jsx)("input",{name:"phone",placeholder:"Phone Number",onChange:y,required:!0,disabled:c})}),(0,s.jsx)("div",{className:l().inputGroup,children:(0,s.jsx)("input",{name:"password",type:"password",placeholder:"Password",onChange:y,required:!0,disabled:c})}),(0,s.jsx)("button",{type:"submit",disabled:c,className:l().btnPrimary,children:c?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("span",{className:l().spinner}),"Sending OTP..."]}):"Continue"})]}):(0,s.jsxs)("form",{onSubmit:f,className:l().form,children:[(0,s.jsx)("div",{className:l().otpContainer,children:(0,s.jsx)("input",{name:"otp",placeholder:"• • • • • •",onChange:y,value:r.otp,ref:h,maxLength:6,inputMode:"numeric",required:!0,disabled:c,className:l().otpInput})}),(0,s.jsx)("button",{type:"submit",disabled:c,className:l().btnPrimary,children:c?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("span",{className:l().spinner}),"Verifying..."]}):"Verify & Create Account"}),(0,s.jsx)("button",{type:"button",onClick:j,disabled:c,className:l().btnSecondary,children:c?"Sending...":"Resend Code"}),(0,s.jsx)("p",{className:l().otpNote,children:"Didn't receive the code? Check your spam folder or try again in 60 seconds."})]}),(0,s.jsx)("div",{className:l().cardFooter,children:(0,s.jsxs)("p",{children:["Already have an account? ",(0,s.jsx)(i(),{href:"/login",className:l().link,children:"Sign In"})]})})]})})}},5695:(e,t,r)=>{"use strict";var s=r(8999);r.o(s,"useRouter")&&r.d(t,{useRouter:function(){return s.useRouter}})},8215:(e,t,r)=>{Promise.resolve().then(r.bind(r,3859))}},e=>{e.O(0,[943,6874,8441,5964,7358],()=>e(e.s=8215)),_N_E=e.O()}]);