(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6266],{3936:e=>{e.exports={dashboardContainer:"Login_dashboardContainer___Bner",mainContent:"Login_mainContent__LrP7H",dashboardHeader:"Login_dashboardHeader__ZzCSO",userInfo:"Login_userInfo__166la",userAvatar:"Login_userAvatar___ewoz",avatarPlaceholder:"Login_avatarPlaceholder__3IJQs",loginCard:"Login_loginCard__K_oI6",cardHeader:"Login_cardHeader__2B8fn",loginForm:"Login_loginForm__SXhV_",formStep:"Login_formStep___AJ0S",inputGroup:"Login_inputGroup__D1INU",otpInstructions:"Login_otpInstructions__vRU2G",otpIcon:"Login_otpIcon__TDFv2",resendButton:"Login_resendButton__apwBk",message:"Login_message__t_Mx4",error:"Login_error__AgYGx",success:"Login_success__9KY8u",submitButton:"Login_submitButton___5mld",buttonLoading:"Login_buttonLoading__h6Mc1",spinner:"Login_spinner__UK__N",spin:"Login_spin__W81Mb",cardFooter:"Login_cardFooter__yOxdJ",dashboardFooter:"Login_dashboardFooter__0UgDX",footerLinks:"Login_footerLinks__AzteY"}},5695:(e,r,n)=>{"use strict";var a=n(8999);n.o(a,"useRouter")&&n.d(r,{useRouter:function(){return a.useRouter}})},6301:(e,r,n)=>{Promise.resolve().then(n.bind(n,8348))},6654:(e,r,n)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"useMergedRef",{enumerable:!0,get:function(){return s}});let a=n(2115);function s(e,r){let n=(0,a.useRef)(null),s=(0,a.useRef)(null);return(0,a.useCallback)(a=>{if(null===a){let e=n.current;e&&(n.current=null,e());let r=s.current;r&&(s.current=null,r())}else e&&(n.current=t(e,a)),r&&(s.current=t(r,a))},[e,r])}function t(e,r){if("function"!=typeof e)return e.current=r,()=>{e.current=null};{let n=e(r);return"function"==typeof n?n:()=>e(null)}}("function"==typeof r.default||"object"==typeof r.default&&null!==r.default)&&void 0===r.default.__esModule&&(Object.defineProperty(r.default,"__esModule",{value:!0}),Object.assign(r.default,r),e.exports=r.default)},8348:(e,r,n)=>{"use strict";n.d(r,{default:()=>d});var a=n(5155),s=n(2115),t=n(2108),i=n(5695);n(6766);var o=n(3936),l=n.n(o);function d(){let[e,r]=(0,s.useState)(""),[n,o]=(0,s.useState)(""),[d,c]=(0,s.useState)(""),[u,h]=(0,s.useState)(""),[_,p]=(0,s.useState)(1),[g,m]=(0,s.useState)(""),[v,f]=(0,s.useState)(!1),x=(0,i.useRouter)(),j=(0,s.useRef)(null);(0,s.useEffect)(()=>{2===_&&j.current&&j.current.focus()},[_]);let b=async r=>{r.preventDefault(),f(!0),m("");let a={redirect:!1,email:e.trim(),password:n,role:d,...2===_&&{otp:u.trim()}},s=await (0,t.signIn)("credentials",a);if(f(!1),null==s?void 0:s.error)try{let e=JSON.parse(s.error);"OTP_REQUIRED"===e.code?(p(2),m("✅ OTP sent to your email. Please enter it below.")):m("❌ ".concat(e.message||"Login failed"))}catch(e){m("❌ ".concat(s.error))}else switch(d){case"admin":x.push("/admin/dashboard");break;case"manager":x.push("/manager/dashboard");break;case"engineer":x.push("/engineer/dashboard");break;default:x.push("/")}},L=async()=>{f(!0),m("");let r=await fetch("/api/auth/send-otp",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e.trim(),role:d})}),n=await r.json();f(!1),r.ok?m("✅ OTP resent to your email."):m("❌ ".concat((null==n?void 0:n.error)||"Failed to resend OTP."))};return(0,a.jsx)("div",{className:l().dashboardContainer,children:(0,a.jsxs)("div",{className:l().mainContent,children:[(0,a.jsxs)("header",{className:l().dashboardHeader,children:[(0,a.jsx)("h1",{children:"Backend Login Portal "}),(0,a.jsxs)("div",{className:l().userInfo,children:[(0,a.jsx)("span",{children:"Secure Backend Login Portal "}),(0,a.jsx)("div",{className:l().userAvatar,children:(0,a.jsx)("div",{className:l().avatarPlaceholder,children:(0,a.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",children:(0,a.jsx)("path",{fillRule:"evenodd",d:"M7.5 6a4.5 4.5 0 119 0 4.5 4.5 0 01-9 0zM3.751 20.105a8.25 8.25 0 0116.498 0 .75.75 0 01-.437.695A18.683 18.683 0 0112 22.5c-2.786 0-5.433-.608-7.812-1.7a.75.75 0 01-.437-.695z",clipRule:"evenodd"})})})})]})]}),(0,a.jsxs)("div",{className:l().loginCard,children:[(0,a.jsxs)("div",{className:l().cardHeader,children:[(0,a.jsx)("h2",{children:"Backend Login Portal "}),(0,a.jsx)("p",{children:1===_?"Enter your credentials":"Verify your identity"})]}),(0,a.jsxs)("form",{onSubmit:b,className:l().loginForm,children:[1===_&&(0,a.jsxs)("div",{className:l().formStep,children:[(0,a.jsxs)("div",{className:l().inputGroup,children:[(0,a.jsx)("label",{htmlFor:"email",children:"Email Address"}),(0,a.jsx)("input",{id:"email",type:"email",placeholder:"Enter your email",value:e,onChange:e=>r(e.target.value),required:!0,disabled:v})]}),(0,a.jsxs)("div",{className:l().inputGroup,children:[(0,a.jsx)("label",{htmlFor:"password",children:"Password"}),(0,a.jsx)("input",{id:"password",type:"password",placeholder:"Enter your password",value:n,onChange:e=>o(e.target.value),required:!0,disabled:v})]}),(0,a.jsxs)("div",{className:l().inputGroup,children:[(0,a.jsx)("label",{htmlFor:"role",children:"Role"}),(0,a.jsxs)("select",{id:"role",value:d,onChange:e=>c(e.target.value),required:!0,disabled:v,children:[(0,a.jsx)("option",{value:"",children:"Select your role"}),(0,a.jsx)("option",{value:"admin",children:"Admin"}),(0,a.jsx)("option",{value:"manager",children:"Manager"}),(0,a.jsx)("option",{value:"engineer",children:"Engineer"})]})]})]}),2===_&&(0,a.jsxs)("div",{className:l().formStep,children:[(0,a.jsxs)("div",{className:l().otpInstructions,children:[(0,a.jsx)("div",{className:l().otpIcon,children:(0,a.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",children:(0,a.jsx)("path",{fillRule:"evenodd",d:"M12 1.5a5.25 5.25 0 00-5.25 5.25v3a3 3 0 00-3 3v6.75a3 3 0 003 3h10.5a3 3 0 003-3v-6.75a3 3 0 00-3-3v-3c0-2.9-2.35-5.25-5.25-5.25zm3.75 8.25v-3a3.75 3.75 0 10-7.5 0v3h7.5z",clipRule:"evenodd"})})}),(0,a.jsx)("p",{children:"We've sent a 6-digit verification code to your email address."})]}),(0,a.jsxs)("div",{className:l().inputGroup,children:[(0,a.jsx)("label",{htmlFor:"otp",children:"Verification Code"}),(0,a.jsx)("input",{ref:j,id:"otp",type:"text",placeholder:"Enter 6-digit code",value:u,onChange:e=>h(e.target.value),maxLength:6,inputMode:"numeric",pattern:"\\d{6}",required:!0,disabled:v})]}),(0,a.jsx)("button",{type:"button",onClick:L,disabled:v,className:l().resendButton,children:v?"Resending...":"Resend Code"})]}),g&&(0,a.jsx)("div",{className:"".concat(l().message," ").concat(g.includes("❌")?l().error:l().success),children:g.replace("✅","").replace("❌","")}),(0,a.jsx)("button",{type:"submit",disabled:v,className:l().submitButton,children:v?(0,a.jsxs)("span",{className:l().buttonLoading,children:[(0,a.jsx)("span",{className:l().spinner}),1===_?"Logging in...":"Verifying..."]}):1===_?"Login":"Verify Code"})]}),(0,a.jsx)("div",{className:l().cardFooter,children:(0,a.jsxs)("p",{children:["Having trouble signing in? ",(0,a.jsx)("a",{href:"admin/register",children:"Register here"})]})})]}),(0,a.jsxs)("div",{className:l().dashboardFooter,children:[(0,a.jsxs)("p",{children:["\xa9 ",new Date().getFullYear()," Admin Portal. All rights reserved."]}),(0,a.jsxs)("div",{className:l().footerLinks,children:[(0,a.jsx)("a",{href:"#",children:"Privacy Policy"}),(0,a.jsx)("a",{href:"#",children:"Terms of Service"}),(0,a.jsx)("a",{href:"#",children:"Help"})]})]})]})})}}}]);