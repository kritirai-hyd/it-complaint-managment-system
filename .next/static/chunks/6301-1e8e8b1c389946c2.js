(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6301],{3936:e=>{e.exports={dashboardContainer:"Login_dashboardContainer___Bner",mainContent:"Login_mainContent__LrP7H",dashboardHeader:"Login_dashboardHeader__ZzCSO",userInfo:"Login_userInfo__166la",userAvatar:"Login_userAvatar___ewoz",avatarPlaceholder:"Login_avatarPlaceholder__3IJQs",loginCard:"Login_loginCard__K_oI6",cardHeader:"Login_cardHeader__2B8fn",loginForm:"Login_loginForm__SXhV_",fadeIn:"Login_fadeIn__mDeSH",fadeOut:"Login_fadeOut__ZCTrf",inputGroup:"Login_inputGroup__D1INU",otpInstructions:"Login_otpInstructions__vRU2G",otpIcon:"Login_otpIcon__TDFv2",submitButton:"Login_submitButton___5mld",buttonLoading:"Login_buttonLoading__h6Mc1",spinner:"Login_spinner__UK__N",spin:"Login_spin__W81Mb",forgotPasswordLink:"Login_forgotPasswordLink__fUKmI",resendButton:"Login_resendButton__apwBk",backToLogin:"Login_backToLogin__jt_dG",message:"Login_message__t_Mx4",slideIn:"Login_slideIn__UMiE6",error:"Login_error__AgYGx",success:"Login_success__9KY8u",cardFooter:"Login_cardFooter__yOxdJ",dashboardFooter:"Login_dashboardFooter__0UgDX",footerLinks:"Login_footerLinks__AzteY"}},5695:(e,s,a)=>{"use strict";var n=a(8999);a.o(n,"useRouter")&&a.d(s,{useRouter:function(){return n.useRouter}})},6301:(e,s,a)=>{Promise.resolve().then(a.bind(a,8348))},8348:(e,s,a)=>{"use strict";a.d(s,{default:()=>l});var n=a(5155),r=a(2115),t=a(2108),i=a(5695),o=a(3936),d=a.n(o);function l(){let[e,s]=(0,r.useState)(""),[a,o]=(0,r.useState)(""),[l,c]=(0,r.useState)(""),[u,h]=(0,r.useState)(""),[m,g]=(0,r.useState)(1),[p,_]=(0,r.useState)(""),[x,v]=(0,r.useState)(!1),[j,b]=(0,r.useState)(0),[f,L]=(0,r.useState)(!1),[y,N]=(0,r.useState)(!1),w=(0,r.useRef)(null),k=(0,i.useRouter)();(0,r.useEffect)(()=>{1===m&&N(""!==e.trim()&&""!==a.trim()&&""!==l)},[e,a,l,m]),(0,r.useEffect)(()=>{2===m&&w.current&&(w.current.focus(),0===j&&b(30))},[m]),(0,r.useEffect)(()=>{if(j>0){let e=setTimeout(()=>b(j-1),1e3);return()=>clearTimeout(e)}},[j]);let C=e=>{L(!0),setTimeout(()=>{g(e),L(!1)},300)},P=async s=>{s.preventDefault(),v(!0),_("");let n=await (0,t.signIn)("credentials",{redirect:!1,email:e.trim(),password:a.trim(),role:l,...2===m&&{otp:u.trim()}});if(v(!1),null==n?void 0:n.error)try{let e=JSON.parse(n.error);"OTP_REQUIRED"===e.code?(C(2),_("✅ OTP sent to your email.")):_("❌ ".concat(e.message||"Login failed."))}catch(e){_("❌ ".concat(n.error))}else switch(l){case"admin":k.push("/admin/dashboard");break;case"manager":k.push("/manager/dashboard");break;case"engineer":k.push("/engineer/dashboard");break;default:k.push("/")}},S=async s=>{s.preventDefault(),v(!0),_("");let a=await fetch("/api/auth/admin-forgot-password",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e})}),n=await a.json();v(!1),a.ok?_("✅ Reset link sent to your email."):_(n.error||"❌ Failed to send reset link.")},I=async()=>{v(!0),_("");let s=await fetch("/api/auth/send-otp",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e.trim(),role:l})}),a=await s.json();v(!1),b(30),s.ok?_("✅ OTP resent to your email."):_("❌ ".concat((null==a?void 0:a.error)||"Failed to resend OTP."))};return(0,n.jsxs)("div",{className:d().dashboardContainer,children:["      ",(0,n.jsxs)("div",{className:d().mainContent,children:[(0,n.jsxs)("header",{className:d().dashboardHeader,children:[(0,n.jsx)("h1",{children:"Backend Login Portal"}),(0,n.jsxs)("div",{className:d().userInfo,children:[(0,n.jsx)("span",{children:"Secure Backend Login Portal"}),(0,n.jsx)("div",{className:d().userAvatar,children:(0,n.jsx)("div",{className:d().avatarPlaceholder,children:(0,n.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",children:(0,n.jsx)("path",{fillRule:"evenodd",d:"M7.5 6a4.5 4.5 0 119 0 4.5 4.5 0 01-9 0zM3.751 20.105a8.25 8.25 0 0116.498 0 .75.75 0 01-.437.695A18.683 18.683 0 0112 22.5c-2.786 0-5.433-.608-7.812-1.7a.75.75 0 01-.437-.695z",clipRule:"evenodd"})})})})]})]}),(0,n.jsxs)("div",{className:d().loginCard,children:[(0,n.jsxs)("div",{className:d().cardHeader,children:[(0,n.jsxs)("h2",{children:[1===m&&"Admin Login",2===m&&"Verify Your Identity",3===m&&"Forgot Password"]}),(0,n.jsxs)("p",{children:[1===m&&"Enter your credentials to access the dashboard.",2===m&&"Enter the OTP sent to your email.",3===m&&"Enter your email to reset your password."]})]}),(0,n.jsxs)("form",{onSubmit:3===m?S:P,className:"".concat(d().loginForm," ").concat(f?d().fadeOut:d().fadeIn),children:[1===m?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{className:d().inputGroup,children:[(0,n.jsx)("label",{children:"Email Address"}),(0,n.jsx)("input",{type:"email",value:e,onChange:e=>s(e.target.value),required:!0,placeholder:"Enter your email",disabled:x})]}),(0,n.jsxs)("div",{className:d().inputGroup,children:[(0,n.jsx)("label",{children:"Password"}),(0,n.jsx)("input",{type:"password",value:a,onChange:e=>o(e.target.value),required:!0,placeholder:"Enter your password",disabled:x})]}),(0,n.jsxs)("div",{className:d().inputGroup,children:[(0,n.jsx)("label",{children:"Role"}),(0,n.jsxs)("select",{value:l,onChange:e=>c(e.target.value),required:!0,disabled:x,children:[(0,n.jsx)("option",{value:"",disabled:!0,children:"Select your role"}),(0,n.jsx)("option",{value:"admin",children:"Admin"}),(0,n.jsx)("option",{value:"manager",children:"Manager"}),(0,n.jsx)("option",{value:"engineer",children:"Engineer"})]})]}),(0,n.jsx)("div",{className:d().forgotPasswordContainer,children:(0,n.jsx)("button",{type:"button",className:d().forgotPasswordLink,onClick:()=>C(3),disabled:x,children:"Forgot Password?"})}),(0,n.jsx)("button",{type:"submit",disabled:x||!y,className:"".concat(d().submitButton," ").concat(y?"":d().disabledButton),children:x?(0,n.jsxs)("span",{className:d().buttonLoading,children:[(0,n.jsx)("span",{className:d().spinner}),"Sending OTP in email..."]}):"Verify OTP"})]}):2===m?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{className:d().otpInstructions,children:[(0,n.jsx)("div",{className:d().otpIcon,children:(0,n.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",children:(0,n.jsx)("path",{fillRule:"evenodd",d:"M12 1.5a5.25 5.25 0 00-5.25 5.25v3a3 3 0 00-3 3v6.75a3 3 0 003 3h10.5a3 3 0 003-3v-6.75a3 3 0 00-3-3v-3c0-2.9-2.35-5.25-5.25-5.25zm3.75 8.25v-3a3.75 3.75 0 10-7.5 0v3h7.5z",clipRule:"evenodd"})})}),(0,n.jsx)("p",{children:"We've sent a 6-digit verification code to your email"})]}),(0,n.jsxs)("div",{className:d().inputGroup,children:[(0,n.jsx)("label",{children:"Enter 6-digit OTP"}),(0,n.jsx)("input",{ref:w,type:"text",value:u,onChange:e=>h(e.target.value.replace(/\D/g,"")),maxLength:6,inputMode:"numeric",placeholder:"123456",required:!0,disabled:x})]}),(0,n.jsx)("button",{type:"submit",disabled:x,className:d().submitButton,children:x?(0,n.jsxs)("span",{className:d().buttonLoading,children:[(0,n.jsx)("span",{className:d().spinner}),"Verifying..."]}):"Verify & Login"}),(0,n.jsx)("button",{type:"button",onClick:I,className:d().resendButton,disabled:x||j>0,children:x?"Resending...":j>0?"Resend in ".concat(j,"s"):"Resend OTP"}),(0,n.jsx)("button",{type:"button",className:d().backToLogin,onClick:()=>C(1),disabled:x,children:"Back to Login"})]}):3===m?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{className:d().otpInstructions,children:[(0,n.jsx)("div",{className:d().otpIcon,children:(0,n.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",children:(0,n.jsx)("path",{fillRule:"evenodd",d:"M12 2.25c-5.385 0-9.75 4.365-9.75 9.75s4.365 9.75 9.75 9.75 9.75-4.365 9.75-9.75S17.385 2.25 12 2.25zm-2.625 6c-.54 0-.828.419-.936.634a1.96 1.96 0 00-.189.866c0 .298.059.605.189.866.108.215.395.634.936.634.54 0 .828-.419.936-.634.13-.26.189-.568.189-.866 0-.298-.059-.605-.189-.866-.108-.215-.395-.634-.936-.634zm4.314.634c.108-.215.395-.634.936-.634.54 0 .828.419.936.634.13.26.189.568.189.866 0 .298-.059.605-.189.866-.108.215-.395.634-.936.634-.54 0-.828-.419-.936-.634a1.96 1.96 0 01-.189-.866c0-.298.059-.605.189-.866zm2.023 6.828a.75.75 0 10-1.06-1.06 3.75 3.75 0 01-5.304 0 .75.75 0 00-1.06 1.06 5.25 5.25 0 007.424 0z",clipRule:"evenodd"})})}),(0,n.jsx)("p",{children:"Enter your email address and we'll send you a password reset link"})]}),(0,n.jsxs)("div",{className:d().inputGroup,children:[(0,n.jsx)("label",{children:"Email Address"}),(0,n.jsx)("input",{type:"email",value:e,onChange:e=>s(e.target.value),required:!0,placeholder:"Enter your email",disabled:x})]}),(0,n.jsx)("button",{type:"submit",disabled:x,className:d().submitButton,children:x?(0,n.jsxs)("span",{className:d().buttonLoading,children:[(0,n.jsx)("span",{className:d().spinner}),"Sending..."]}):"Send Reset Link"}),(0,n.jsx)("button",{type:"button",className:d().backToLogin,onClick:()=>C(1),disabled:x,children:"Back to Login"})]}):void 0,p&&(0,n.jsx)("div",{className:"".concat(d().message," ").concat(p.includes("✅")?d().success:d().error),children:p.replace("✅","").replace("❌","")})]})]})]}),(0,n.jsxs)("footer",{className:d().dashboardFooter,children:[(0,n.jsxs)("p",{children:["\xa9 ",new Date().getFullYear()," Admin Portal. All rights reserved."]}),(0,n.jsxs)("div",{className:d().footerLinks,children:[(0,n.jsx)("a",{href:"#",children:"Privacy Policy"}),(0,n.jsx)("a",{href:"#",children:"Terms of Service"}),(0,n.jsx)("a",{href:"#",children:"Contact Support"})]})]})]})}}}]);