(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4520],{2698:(e,s,t)=>{"use strict";t.d(s,{default:()=>l});var n=t(5155),o=t(2115),i=t(2108),a=t(5695),r=t(4814),d=t.n(r);function l(){let[e,s]=(0,o.useState)(""),[t,r]=(0,o.useState)(""),[l,c]=(0,o.useState)(""),[u,p]=(0,o.useState)(1),[m,g]=(0,o.useState)(""),[h,_]=(0,o.useState)(!1),[f,x]=(0,o.useState)(!1),[b,j]=(0,o.useState)(0),[v,L]=(0,o.useState)(!1),N=(0,o.useRef)(null),y=(0,a.useRouter)();(0,o.useEffect)(()=>{L(""!==e.trim()&&""!==t.trim())},[e,t]),(0,o.useEffect)(()=>{2===u&&N.current&&N.current.focus(),2===u&&0===b&&j(30)},[u]),(0,o.useEffect)(()=>{if(b>0){let e=setTimeout(()=>j(b-1),1e3);return()=>clearTimeout(e)}},[b]);let k=e=>{x(!0),setTimeout(()=>{p(e),x(!1)},300)},S=async s=>{s.preventDefault(),_(!0),g("");let n=await (0,i.signIn)("credentials",{redirect:!1,email:e,password:t,role:"user",...2===u&&{otp:l}});if(_(!1),null==n?void 0:n.error)try{let e=JSON.parse(n.error);"OTP_REQUIRED"===e.code?(k(2),g("✅ OTP sent to your email.")):g(e.message||"❌ Login failed.")}catch(e){g(n.error||"❌ Unexpected error.")}else y.push("/user/dashboard")},w=async s=>{s.preventDefault(),_(!0),g("");let t=await fetch("/api/auth/user-forgot-password",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e})}),n=await t.json();_(!1),t.ok?g("✅ Reset link sent to your email."):g(n.error||"❌ Failed to send reset link.")},C=async()=>{_(!0),g("");let s=await fetch("/api/auth/send-otp",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e,role:"user"})}),t=await s.json();_(!1),j(30),s.ok?g("✅ OTP resent. Check your email."):g(t.error||"❌ Could not resend OTP.")};return(0,n.jsx)("div",{className:d().loginContainer,children:(0,n.jsxs)("div",{className:d().loginCard,children:[(0,n.jsxs)("div",{className:d().loginHeader,children:[(0,n.jsxs)("h2",{children:[1===u&&"Welcome Back",2===u&&"Verify Your Account",3===u&&"Reset Password"]}),(0,n.jsxs)("p",{children:[1===u&&"Sign in to access your account",2===u&&"Enter the code sent to your email",3===u&&"We'll help you get back into your account"]})]}),(0,n.jsxs)("form",{onSubmit:3===u?w:S,className:d().loginForm,children:[1===u?(0,n.jsxs)("div",{className:"".concat(d().formStep," ").concat(f?d().fadeOut:d().fadeIn),children:[(0,n.jsxs)("div",{className:d().inputGroup,children:[(0,n.jsx)("label",{htmlFor:"email",children:"Email"}),(0,n.jsx)("input",{id:"email",type:"email",value:e,onChange:e=>s(e.target.value),required:!0,placeholder:"Enter your email",disabled:h})]}),(0,n.jsxs)("div",{className:d().inputGroup,children:[(0,n.jsx)("label",{htmlFor:"password",children:"Password"}),(0,n.jsx)("input",{id:"password",type:"password",value:t,onChange:e=>r(e.target.value),required:!0,placeholder:"Enter your password",disabled:h})]}),(0,n.jsx)("button",{type:"button",onClick:()=>k(3),className:d().forgotPasswordLink,disabled:h,children:"Forgot Password?"}),(0,n.jsx)("button",{type:"submit",disabled:h||!v,className:"".concat(d().submitButton," ").concat(v?"":d().inactiveButton),children:h?(0,n.jsxs)("div",{className:d().buttonLoading,children:[(0,n.jsx)("div",{className:d().spinner}),(0,n.jsx)("span",{children:"Verifying..."})]}):"Verify OTP"})]}):2===u?(0,n.jsxs)("div",{className:"".concat(d().formStep," ").concat(f?d().fadeOut:d().fadeIn),children:[(0,n.jsxs)("div",{className:d().otpHeader,children:[(0,n.jsx)("h3",{children:"Enter Verification Code"}),(0,n.jsx)("p",{children:"We've sent a 6-digit code to your email"})]}),(0,n.jsxs)("div",{className:d().inputGroup,children:[(0,n.jsx)("label",{htmlFor:"otp",children:"Verification Code"}),(0,n.jsx)("input",{id:"otp",ref:N,type:"text",maxLength:6,inputMode:"numeric",value:l,onChange:e=>c(e.target.value.replace(/\D/g,"")),required:!0,placeholder:"Enter 6-digit code",className:d().otpInput,disabled:h})]}),(0,n.jsxs)("div",{className:d().otpResend,children:[(0,n.jsx)("p",{children:"Didn't receive the code?"}),(0,n.jsx)("button",{type:"button",onClick:C,disabled:h||b>0,className:b>0?d().countdownActive:"",children:h?"Sending...":b>0?"Resend in ".concat(b,"s"):"Resend Code"})]}),(0,n.jsx)("button",{type:"submit",disabled:h,className:d().submitButton,children:h?(0,n.jsxs)("div",{className:d().buttonLoading,children:[(0,n.jsx)("div",{className:d().spinner}),(0,n.jsx)("span",{children:"Verifying OTP..."})]}):"Verify & Continue"}),(0,n.jsx)("button",{type:"button",onClick:()=>k(1),className:d().backToLogin,disabled:h,children:"Back to Login"})]}):3===u?(0,n.jsxs)("div",{className:"".concat(d().formStep," ").concat(f?d().fadeOut:d().fadeIn),children:[(0,n.jsxs)("div",{className:d().forgotPasswordHeader,children:[(0,n.jsx)("h3",{children:"Reset Your Password"}),(0,n.jsx)("p",{children:"Enter your email to receive a reset link"})]}),(0,n.jsxs)("div",{className:d().inputGroup,children:[(0,n.jsx)("label",{htmlFor:"reset-email",children:"Email"}),(0,n.jsx)("input",{id:"reset-email",type:"email",value:e,onChange:e=>s(e.target.value),required:!0,placeholder:"Enter your email",disabled:h})]}),(0,n.jsx)("button",{type:"submit",disabled:h,className:d().submitButton,children:h?(0,n.jsxs)("div",{className:d().buttonLoading,children:[(0,n.jsx)("div",{className:d().spinner}),(0,n.jsx)("span",{children:"Sending reset link..."})]}):"Send Reset Link"}),(0,n.jsx)("button",{type:"button",onClick:()=>k(1),className:d().backToLogin,disabled:h,children:"Back to Login"})]}):void 0,m&&(0,n.jsx)("div",{className:"".concat(d().message," ").concat(m.includes("✅")?d().success:d().error),children:m})]}),(0,n.jsx)("div",{className:d().cardFooter,children:(0,n.jsxs)("p",{children:["Don't have an account? ",(0,n.jsx)("a",{href:"/register",children:"Register Here"})]})})]})})}},4457:(e,s,t)=>{Promise.resolve().then(t.bind(t,2698))},4814:e=>{e.exports={loginContainer:"Login_loginContainer__hA_pw",loginCard:"Login_loginCard__SHhGx",fadeIn:"Login_fadeIn__waWAN",loginHeader:"Login_loginHeader__NMeno",loginForm:"Login_loginForm__xVBFv",formStep:"Login_formStep__fOAfk",fadeOut:"Login_fadeOut__tJPG9",inputGroup:"Login_inputGroup__8lUG9",otpInput:"Login_otpInput__ETLo7",otpHeader:"Login_otpHeader__BygG_",forgotPasswordHeader:"Login_forgotPasswordHeader__ofKe0",forgotPasswordLink:"Login_forgotPasswordLink__Np7Kv",backToLogin:"Login_backToLogin__J5wET",submitButton:"Login_submitButton__LYzpR",buttonLoader:"Login_buttonLoader__zb66L",spin:"Login_spin__Gg_oc",otpResend:"Login_otpResend__DDHXb",message:"Login_message__NVGU_",fadeSlideIn:"Login_fadeSlideIn__0qh66",success:"Login_success__v2F9N",error:"Login_error__1AWB3",cardFooter:"Login_cardFooter__cdbUX",inactiveButton:"Login_inactiveButton__F0VuJ"}},5695:(e,s,t)=>{"use strict";var n=t(8999);t.o(n,"useRouter")&&t.d(s,{useRouter:function(){return n.useRouter}})}},e=>{e.O(0,[2805,2108,8441,5964,7358],()=>e(e.s=4457)),_N_E=e.O()}]);